# Webook
### Online Technical Course
* The instructor is a senior backend engineer from China who previously worked at Shopee and eBay.
* [Course link](https://u.geekbang.org/subject/go3rd)
### Project Structure
* cmd: Project entry point
    * wire: Defines dependencies between layers in the project source code
    * wire_gen: Generated by the wire command based on wire.go, completes dependency injection
    * app.go: Defines the services included in the project
    * main.go: Root of the project; starts the corresponding services defined in app.go
    * prometheus.go: Starts the Prometheus server
* config: Project environment configurations
* deployment
    * k8s yaml
* internal
    * domain: Domain models
    * interface
        * event: Event consumer & handler
        * job: Cronjob handler
        * web: Web controller & handler
            * handler: Web handler
                * view: Web handler input/output view model
    * repo: Repository Aggregation
      * cache: Redis
      * dao: DB(MySQL or MongoDB)
    * service: Application services
    * pkg
      * ginx: Enhanced modules for Gin
      * errcode: Define various system error codes
* ioc: Inversion of Control. Initialization of various root modules
* pkg
    * loggerx: Logger module
    * ratelimit: Rate limit utility package
    * errorx: Error code utility package
    * trace_id: Trace ID utility package
    * samarax: message handlers for both single and batch processing based on Samara
* scripts: Scripts for environment management and infrastructure deployment

### Completed Milestones
* Optimized the original course project structure by referencing various Go project architectures.
* Introduced Dependency Injection (DI) and Inversion of Control (IoC) to make the project scalable and testable.
* Integrated with a third-party SMS provider while considering failover, rate limiting, and retries. Used the Decorator pattern to flexibly enhance the security and availability of the SMS service, as shown in the /internal/service/sms folder.
* Built a secure authentication system using browser user agent, JWT, cookies, and sessions.
* Implemented the Sliding Window Rate Limit algorithm.
* Designed and implemented Redis Lua scripts to handle concurrency issues in the login_sms_send_code.go SMS sending API. This ensured atomic rate-limiting operations under high traffic, preventing duplicate sends and improving overall system stability and user experience.
* Learned error code handling from the [course](https://time.geekbang.org/column/intro/418?tab=catalo) and implemented it in this project as well as in my current company's projects, improving maintainability by avoiding deep error propagation.
* Designed and implemented a severity-based error classification system integrated into application logs, categorizing issues into four priority levels:
  * This classification reduced product operation impact on day-to-day development.
  * P0: Critical system errors requiring immediate attention 
  * P1: High-priority errors to be resolved within the same day 
  * P2: Lower-risk issues that can be addressed later in the week 
  * P3: Informational logs or user-side errors not necessarily related to system faults
### Future Plan
* Course Modules in Progress
  * Distributed Job Scheduling
  * Introduction to DDD and Splitting Monolithic Applications into Microservices 
  * Zero-Downtime Data Migration Solutions 
  * Microservices Development: Service Registration and Discovery, Load Balancing, and Service Governance 
  * Design and Implementation of a Payment Service 
  * ElasticSearch and Search Service Implementation 
  * ELK and Canal 
  * Feed Stream Design and Implementation 
  * Design and Implementation of an Instant Messaging (IM) Service
* CI/CD Improvements
  * Move .env, Terraform files, and secrets to a separate repository, using git-crypt for encryption to enhance security.
  * Introduce Git Submodules to integrate source code and env repositories for streamlined deployment.
  * Use Terraform under the deployment directory to:
    * Create CI/CD IAM roles 
    * Deploy services to AWS EKS 
    * Provision necessary AWS resources